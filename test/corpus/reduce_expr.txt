======
Simple reduce
======
REDUCE string( INIT s = 0 
                 FOR i = 1 UNTIL i > 10 
                 NEXT s = i )
---

(source
  (reduce_expression
    (keyword_reduce)
    (type_identifier)
    (reduce_init
      (keyword_init)
      (init_spec
        (identifier)
        (number)))
    (conditional_iteration
      (keyword_for)
      (assignment
        (identifier)
        (number))
      (keyword_until)
      (comparison_expression
        (identifier)
        (number)))
    (reduce_next
      (keyword_next)
      (assignment
        (identifier)
        (identifier)))))

======
Reduce with initial init var
======
REDUCE string( INIT text type string
                FOR n = 10 THEN n - 1 WHILE n > 0 
                NEXT text &&= | { n }| )
---

(source
  (reduce_expression
    (keyword_reduce)
    (type_identifier)
    (reduce_init
      (keyword_init)
      (init_spec
        (identifier)
        (builtin_type_spec
          (keyword_type)
          (type_identifier))))
    (conditional_iteration
      (keyword_for)
      (assignment
        (identifier)
        (number))
      (keyword_then)
      (binary_operator
        (identifier)
        (number))
      (keyword_while)
      (comparison_expression
        (identifier)
        (number)))
    (reduce_next
      (keyword_next)
      (assignment
        (identifier)
        (string_template
          (embedded_expression
            (identifier)))))))

======
Reduce with multiple init / next steps
======
REDUCE result( INIT res = VALUE result( max = 0 text = `Result: ` ) 
                    sep  = `` 
                     FOR <wa> IN itab 
                       NEXT res-text &&= sep && <wa>-id 
                            res-sum += <wa>-num 
                            res-max = nmax( val1 = res-max 
                                            val2 = <wa>-num ) 
                            sep     = `-` ).
---

(source
  (reduce_expression
    (keyword_reduce)
    (type_identifier)
    (reduce_init
      (keyword_init)
      (init_spec
        (identifier)
        (value_expression
          (keyword_value)
          (type_identifier)
          (argument_list
            (named_argument
              (identifier)
              (number))
            (named_argument
              (identifier)
              (string_literal)))))
      (init_spec
        (identifier)
        (string_literal)))
    (table_iteration
      (keyword_for)
      (field_symbol
        (identifier))
      (keyword_in)
      (identifier))
    (reduce_next
      (keyword_next)
      (assignment
        (struct_component_selector
          (identifier)
          (identifier))
        (binary_operator
          (string_operator
            (identifier)
            (field_symbol
              (identifier)))
          (identifier)))
      (assignment
        (struct_component_selector
          (identifier)
          (identifier))
        (binary_operator
          (field_symbol
            (identifier))
          (identifier)))
      (assignment
        (struct_component_selector
          (identifier)
          (identifier))
        (builtin_function_call
          (identifier)
          (call_argument_list
            (argument_list
              (named_argument
                (identifier)
                (struct_component_selector
                  (identifier)
                  (identifier)))
              (named_argument
                (identifier)
                (binary_operator
                  (field_symbol
                    (identifier))
                  (identifier)))))))
      (assignment
        (identifier)
        (string_literal)))))

======
Reduce with nested constructor expressions
======
REDUCE string( INIT text = `` sep = `` 
        "Table reduction 
        FOR word IN VALUE strings( 
          "Table comprehension 
          FOR word IN words 
           ( SWITCH #( word WHEN `All`        THEN `Some` 
                            WHEN `imperative` THEN `functional` 
                            ELSE word ) ) ) 
        NEXT text = |{ text }{ sep }{ word }| sep = ` ` )
---

(source
  (reduce_expression
    (keyword_reduce)
    (type_identifier)
    (reduce_init
      (keyword_init)
      (init_spec
        (identifier)
        (string_literal))
      (init_spec
        (identifier)
        (string_literal)))
    (inline_comment)
    (table_iteration
      (keyword_for)
      (identifier)
      (keyword_in)
      (value_expression
        (keyword_value)
        (type_identifier)
        (inline_comment)
        (itab_expression
          (table_iteration
            (keyword_for)
            (identifier)
            (keyword_in)
            (identifier))
          (line_spec
            (argument_list
              (positional_argument
                (switch_expression
                  (keyword_switch)
                  (identifier)
                  (case
                    (keyword_when)
                    (string_literal)
                    (keyword_then)
                    (string_literal))
                  (case
                    (keyword_when)
                    (string_literal)
                    (keyword_then)
                    (string_literal))
                  (case
                    (keyword_else)
                    (identifier)))))))))
    (reduce_next
      (keyword_next)
      (assignment
        (identifier)
        (string_template
          (embedded_expression
            (identifier))
          (embedded_expression
            (identifier))
          (embedded_expression
            (identifier))))
      (assignment
        (identifier)
        (string_literal)))))
